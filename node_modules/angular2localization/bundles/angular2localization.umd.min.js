(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?factory(exports,require("@angular/core"),require("@angular/http"),require("rxjs/Observable"),require("rxjs/add/operator/map"),require("rxjs/add/observable/merge"),require("@angular/common"),require("@angular/forms")):typeof define==="function"&&define.amd?define(["exports","@angular/core","@angular/http","rxjs/Observable","rxjs/add/operator/map","rxjs/add/observable/merge","@angular/common","@angular/forms"],factory):factory((global.ng=global.ng||{},global.ng.angular2localization=global.ng.angular2localization||{}),global.ng.core,global.ng.http,global.Rx,global.Rx,null,global.ng.common,global.ng.forms)})(this,function(exports,_angular_core,_angular_http,rxjs_Observable,rxjs_add_operator_map,rxjs_add_observable_merge,_angular_common,_angular_forms){"use strict";var LocaleService=function(){function LocaleService(){this.defaultLocaleChanged=new _angular_core.EventEmitter(true);this.languageCodeChanged=new _angular_core.EventEmitter(true);this.countryCodeChanged=new _angular_core.EventEmitter(true);this.currencyCodeChanged=new _angular_core.EventEmitter(true);this.scriptCodeChanged=new _angular_core.EventEmitter(true);this.numberingSystemChanged=new _angular_core.EventEmitter(true);this.calendarChanged=new _angular_core.EventEmitter(true);this.updateLocalization=new _angular_core.EventEmitter(true);this.enableCookie=false;this.enableLocalStorage=false;this.languageCodes=[];this.languageCode="";this.countryCode="";this.currencyCode="";this.defaultLocale="";this.scriptCode="";this.numberingSystem="";this.calendar="";LocaleService.referenceCounter++;if(LocaleService.referenceCounter==1){this.enableCookie=true}}LocaleService.prototype.addLanguage=function(language){this.languageCodes.push(language)};LocaleService.prototype.addLanguages=function(languages){for(var _i=0,languages_1=languages;_i<languages_1.length;_i++){var language=languages_1[_i];this.languageCodes.push(language)}};LocaleService.prototype.getAvailableLanguages=function(){return this.languageCodes};LocaleService.prototype.useLocalStorage=function(){this.enableLocalStorage=true};LocaleService.prototype.definePreferredLanguage=function(defaultLanguage,expiry){this.expiry=expiry;this.parseStorage("locale");if(this.languageCode==""){this.languageCode=defaultLanguage;var browserLanguage="";if(typeof navigator.language!="undefined"){browserLanguage=navigator.language}if(browserLanguage!=""){var index=browserLanguage.indexOf("-");if(index!=-1){browserLanguage=browserLanguage.substring(0,index)}if(this.languageCodes.length>0&&this.languageCodes.indexOf(browserLanguage)!=-1){this.languageCode=browserLanguage}}}this.setDefaultLocale()};LocaleService.prototype.definePreferredLocale=function(defaultLanguage,defaultCountry,expiry,script,numberingSystem,calendar){if(script===void 0){script=""}if(numberingSystem===void 0){numberingSystem=""}if(calendar===void 0){calendar=""}this.expiry=expiry;this.parseStorage("locale");if(this.languageCode==""||this.countryCode==""){this.languageCode=defaultLanguage;this.countryCode=defaultCountry;this.scriptCode=script;this.numberingSystem=numberingSystem;this.calendar=calendar}this.setDefaultLocale()};LocaleService.prototype.definePreferredCurrency=function(defaultCurrency){this.parseStorage("currency");if(this.currencyCode==""){this.currencyCode=defaultCurrency}this.setStorage("currency",this.currencyCode)};LocaleService.prototype.getCurrentLanguage=function(){return this.languageCode};LocaleService.prototype.getCurrentCountry=function(){return this.countryCode};LocaleService.prototype.getCurrentCurrency=function(){return this.currencyCode};LocaleService.prototype.getScript=function(){return this.scriptCode};LocaleService.prototype.getNumberingSystem=function(){return this.numberingSystem};LocaleService.prototype.getCalendar=function(){return this.calendar};LocaleService.prototype.setCurrentLanguage=function(language){if(this.languageCode!=language){this.languageCode=language;this.setDefaultLocale();this.updateLocalization.emit(null);this.languageCodeChanged.emit(language)}};LocaleService.prototype.setCurrentLocale=function(language,country,script,numberingSystem,calendar){if(script===void 0){script=""}if(numberingSystem===void 0){numberingSystem=""}if(calendar===void 0){calendar=""}if(this.languageCode!=language||this.countryCode!=country||this.scriptCode!=script||this.numberingSystem!=numberingSystem||this.calendar!=calendar){var changes={};changes["languageCode"]=this.languageCode!=language?true:false;changes["countryCode"]=this.countryCode!=country?true:false;changes["scriptCode"]=this.scriptCode!=script?true:false;changes["numberingSystem"]=this.numberingSystem!=numberingSystem?true:false;changes["calendar"]=this.calendar!=calendar?true:false;this.languageCode=language;this.countryCode=country;this.scriptCode=script;this.numberingSystem=numberingSystem;this.calendar=calendar;this.setDefaultLocale();if(changes["languageCode"]||changes["countryCode"]){this.updateLocalization.emit(null)}if(changes["languageCode"]){this.languageCodeChanged.emit(language)}if(changes["countryCode"]){this.countryCodeChanged.emit(country)}if(changes["scriptCode"]){this.scriptCodeChanged.emit(script)}if(changes["numberingSystem"]){this.numberingSystemChanged.emit(numberingSystem)}if(changes["calendar"]){this.calendarChanged.emit(calendar)}}};LocaleService.prototype.setCurrentCurrency=function(currency){if(this.currencyCode!=currency){this.currencyCode=currency;this.setStorage("currency",this.currencyCode);this.currencyCodeChanged.emit(currency)}};LocaleService.prototype.getDefaultLocale=function(){return this.defaultLocale};LocaleService.prototype.setDefaultLocale=function(){this.defaultLocale=this.languageCode;this.defaultLocale+=this.scriptCode!=""?"-"+this.scriptCode:"";this.defaultLocale+=this.countryCode!=""?"-"+this.countryCode:"";this.defaultLocale+=this.numberingSystem!=""||this.calendar!=""?"-u":"";this.defaultLocale+=this.numberingSystem!=""?"-nu-"+this.numberingSystem:"";this.defaultLocale+=this.calendar!=""?"-ca-"+this.calendar:"";this.setStorage("locale",this.defaultLocale);this.defaultLocaleChanged.emit(this.defaultLocale)};LocaleService.prototype.parseStorage=function(name){var storage="";if(this.enableLocalStorage&&this.verifyLocalStorage){storage=this.getLocalStorage(name)}else if(this.enableCookie&&this.languageCodes.length>0&&this.verifyCookie){storage=this.getCookie(name)}if(storage!=""){var index=storage.search("-u");if(index!=-1){var extensions=storage.substring(index+1).split("-");switch(extensions.length){case 3:if(extensions[1]=="nu"){this.numberingSystem=extensions[2]}else if(extensions[1]=="ca"){this.calendar=extensions[2]}break;case 5:this.numberingSystem=extensions[2];this.calendar=extensions[4];break}storage=storage.substring(0,index)}var codes=storage.split("-");switch(codes.length){case 1:if(name=="locale"){this.languageCode=codes[0]}else if(name=="currency"){this.currencyCode=codes[0]}break;case 2:this.languageCode=codes[0];this.countryCode=codes[1];break;case 3:this.languageCode=codes[0];this.scriptCode=codes[1];this.countryCode=codes[2];break}}};LocaleService.prototype.verifyLocalStorage=function(){return typeof Storage!="undefined"};LocaleService.prototype.verifyCookie=function(){return typeof navigator.cookieEnabled!="undefined"&&navigator.cookieEnabled};LocaleService.prototype.setStorage=function(name,value){if(this.enableLocalStorage&&this.verifyLocalStorage){this.setLocalStorage(name,value)}else if(this.enableCookie==true&&this.languageCodes.length>0&&this.verifyCookie){this.setCookie(name,value,this.expiry)}};LocaleService.prototype.setLocalStorage=function(name,value){localStorage.setItem(name,value)};LocaleService.prototype.getLocalStorage=function(name){return localStorage.getItem(name)!=null?localStorage.getItem(name):""};LocaleService.prototype.setCookie=function(name,value,days){if(days!=null){var expirationDate=new Date;expirationDate.setTime(expirationDate.getTime()+days*24*60*60*1e3);var expires="; expires="+expirationDate.toUTCString()}else{var expires=""}document.cookie=name+"="+value+expires+"; path=/"};LocaleService.prototype.getCookie=function(name){name+="=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1)}if(c.indexOf(name)==0){return c.substring(name.length,c.length)}}return""};LocaleService.referenceCounter=0;LocaleService.decorators=[{type:_angular_core.Injectable}];LocaleService.ctorParameters=function(){return[]};LocaleService.propDecorators={defaultLocaleChanged:[{type:_angular_core.Output}],languageCodeChanged:[{type:_angular_core.Output}],countryCodeChanged:[{type:_angular_core.Output}],currencyCodeChanged:[{type:_angular_core.Output}],scriptCodeChanged:[{type:_angular_core.Output}],numberingSystemChanged:[{type:_angular_core.Output}],calendarChanged:[{type:_angular_core.Output}],updateLocalization:[{type:_angular_core.Output}]};return LocaleService}();var IntlSupport=function(){function IntlSupport(){}IntlSupport.DateTimeFormat=function(defaultLocale){try{new Intl.DateTimeFormat(defaultLocale).format(new Date)}catch(e){return false}return true};IntlSupport.NumberFormat=function(defaultLocale){try{var n=0;new Intl.NumberFormat(defaultLocale).format(n)}catch(e){return false}return true};IntlSupport.Collator=function(lang){try{var value1="a";var value2="b";new Intl.Collator(lang).compare(value1,value2)}catch(e){return false}return true};return IntlSupport}();var LocalizationService=function(){function LocalizationService(http,locale){var _this=this;this.http=http;this.locale=locale;this.translationChanged=new _angular_core.EventEmitter(true);this.enableLocale=false;this.providers=[];this.translationData={};this.composedKey=true;this.keySeparator=".";this.languageCode="";this.loadingMode=LoadingMode.Direct;this.serviceState=ServiceState.isWaiting;this.locale.updateLocalization.subscribe(function(){return _this.updateTranslation()})}LocalizationService.prototype.addTranslation=function(language,translation){this.addData(translation,language)};LocalizationService.prototype.translationProvider=function(prefix,dataFormat,webAPI){if(dataFormat===void 0){dataFormat="json"}if(webAPI===void 0){webAPI=false}this.addProvider(prefix,dataFormat,webAPI)};LocalizationService.prototype.addProvider=function(prefix,dataFormat,webAPI){if(dataFormat===void 0){dataFormat="json"}if(webAPI===void 0){webAPI=false}this.providers.push({prefix:prefix,dataFormat:dataFormat,webAPI:webAPI});if(this.providers.length==1){this.loadingMode=LoadingMode.Async}};LocalizationService.prototype.translate=function(key,args,lang){if(lang===void 0){lang=this.languageCode}var value;if(this.translationData[lang]!=null){var translation=this.translationData[lang];if(this.composedKey){var keys=key.split(this.keySeparator);do{key=keys.shift();if(translation[key]!=null&&typeof translation[key]=="object"){translation=translation[key]}}while(keys.length>0)}value=translation[key]}if(value==null||value==""){if(this.missingKey){return this.translate(this.missingKey,args,lang)}else if(this.missingValue){return this.missingValue}return key}else if(args!=null){var TEMPLATE_REGEXP=/{{\s?([^{}\s]*)\s?}}/g;return value.replace(TEMPLATE_REGEXP,function(substring,parsedKey){var response=args[parsedKey];return typeof response!=="undefined"?response:substring})}return value};LocalizationService.prototype.translateAsync=function(key,args,lang){var _this=this;if(lang===void 0){lang=this.languageCode}return rxjs_Observable.Observable.create(function(observer){var value=_this.translate(key,args,lang);observer.next(value);observer.complete()})};LocalizationService.prototype.useLocaleAsLanguage=function(){this.enableLocale=true};LocalizationService.prototype.updateTranslation=function(language){if(language===void 0){language=!this.enableLocale?this.locale.getCurrentLanguage():this.locale.getCurrentLanguage()+"-"+this.locale.getCurrentCountry()}if(language!=""&&language!=this.languageCode){if(this.loadingMode==LoadingMode.Async){this.getTranslation(language)}else{this.translationComplete(language)}}};LocalizationService.prototype.setMissingValue=function(value){this.missingValue=value};LocalizationService.prototype.setMissingKey=function(key){this.missingKey=key};LocalizationService.prototype.setComposedKey=function(composedKey,keySeparator){this.composedKey=composedKey;this.keySeparator=keySeparator};LocalizationService.prototype.compare=function(key1,key2,extension,options){if(IntlSupport.Collator(this.locale.getCurrentLanguage())==false){return 0}var value1=this.translate(key1);var value2=this.translate(key2);var locale=this.addExtension(this.locale.getCurrentLanguage(),extension);return new Intl.Collator(locale).compare(value1,value2)};LocalizationService.prototype.sort=function(list,keyName,order,extension,options){if(list==null||keyName==null||IntlSupport.Collator(this.locale.getCurrentLanguage())==false){return list}for(var _i=0,list_1=list;_i<list_1.length;_i++){var item=list_1[_i];var value=this.translate(item[keyName]);var translated=keyName.concat("Translated");item[translated]=value}var locale=this.addExtension(this.locale.getCurrentLanguage(),extension);var collator=new Intl.Collator(locale,options);list.sort(function(a,b){return collator.compare(a[translated],b[translated])});var index=list.indexOf(translated,0);if(index>-1){list.splice(index,1)}if(order!=null&&order=="desc"){list.reverse()}return list};LocalizationService.prototype.sortAsync=function(list,keyName,order,extension,options){var _this=this;return rxjs_Observable.Observable.create(function(observer){observer.next(_this.sort(list,keyName,order,extension,options));observer.complete()})};LocalizationService.prototype.search=function(s,list,keyNames,options){var _this=this;if(options===void 0){options={usage:"search"}}if(list==null||keyNames==null||s==""||IntlSupport.Collator(this.locale.getCurrentLanguage())==false){return list}var translated=new Array;var i=0;for(var i=0;i<keyNames.length;i++){translated.push(keyNames[i].concat("Translated"));for(var _i=0,list_2=list;_i<list_2.length;_i++){var item=list_2[_i];var value=this.translate(item[keyNames[i]]);item[translated[i]]=value}}var locale=this.locale.getCurrentLanguage();var collator=new Intl.Collator(locale,options);var matches=list.filter(function(v){var found=false;for(var i=0;i<translated.length;i++){if(_this.match(v[translated[i]],s,collator)){found=true;break}}return found});for(var i=0;i<translated.length;i++){var index=matches.indexOf(translated[i],0);if(index>-1){matches.splice(index,1)}}return matches};LocalizationService.prototype.searchAsync=function(s,list,keyNames,options){var _this=this;if(options===void 0){options={usage:"search"}}if(list==null){return null}if(keyNames==null||s==""||IntlSupport.Collator(this.locale.getCurrentLanguage())==false){return rxjs_Observable.Observable.create(function(observer){for(var _i=0,list_3=list;_i<list_3.length;_i++){var item=list_3[_i];observer.next(item)}observer.complete()})}return rxjs_Observable.Observable.create(function(observer){var translated=new Array;var i=0;for(var i=0;i<keyNames.length;i++){translated.push(keyNames[i].concat("Translated"));for(var _i=0,list_4=list;_i<list_4.length;_i++){var item=list_4[_i];var value=_this.translate(item[keyNames[i]]);item[translated[i]]=value}}var locale=_this.locale.getCurrentLanguage();var collator=new Intl.Collator(locale,options);for(var _a=0,list_5=list;_a<list_5.length;_a++){var v=list_5[_a];for(var i=0;i<translated.length;i++){if(_this.match(v[translated[i]],s,collator)){observer.next(v);break}}}for(var i=0;i<translated.length;i++){var index=list.indexOf(translated[i],0);if(index>-1){list.splice(index,1)}}observer.complete()})};LocalizationService.prototype.addExtension=function(locale,extension){if(extension!=null&&extension!=""){locale=locale+"-"+extension}return locale};LocalizationService.prototype.match=function(v,s,collator){var vLength=v.length;var sLength=s.length;if(sLength>vLength){return false}if(sLength==vLength){return collator.compare(v,s)===0}var found=false;for(var i=0;i<vLength-(sLength-1);i++){var str=v.substr(i,sLength);if(collator.compare(str,s)===0){found=true;break}}return found};LocalizationService.prototype.getTranslation=function(language){var _this=this;this.translationData={};this.serviceState=ServiceState.isLoading;var observableSequencesOfTranslationData=[];for(var _i=0,_a=this.providers;_i<_a.length;_i++){var provider=_a[_i];var url=provider.prefix;if(provider.webAPI==true){url+=language}else{url+=language+"."+provider.dataFormat}observableSequencesOfTranslationData.push(this.getTranslationByProvider(url))}rxjs_Observable.Observable.merge.apply(rxjs_Observable.Observable,observableSequencesOfTranslationData).subscribe(function(data){_this.addData(data,language)},function(error){console.error("Localization service:",error)},function(){_this.translationComplete(language)})};LocalizationService.prototype.getTranslationByProvider=function(url){return this.http.get(url).map(function(res){return res.json()})};LocalizationService.prototype.addData=function(data,language){this.translationData[language]=typeof this.translationData[language]!="undefined"?this.extend(this.translationData[language],data):data};LocalizationService.prototype.extend=function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i-0]=arguments[_i]}var newObj={};for(var _a=0,args_1=args;_a<args_1.length;_a++){var obj=args_1[_a];for(var key in obj){newObj[key]=obj[key]}}return newObj};LocalizationService.prototype.translationComplete=function(language){this.serviceState=ServiceState.isReady;this.languageCode=language;this.translationChanged.emit(language)};LocalizationService.decorators=[{type:_angular_core.Injectable}];LocalizationService.ctorParameters=function(){return[{type:_angular_http.Http},{type:LocaleService}]};LocalizationService.propDecorators={translationChanged:[{type:_angular_core.Output}]};return LocalizationService}();var ServiceState={};ServiceState.isReady=0;ServiceState.isLoading=1;ServiceState.isWaiting=2;ServiceState[ServiceState.isReady]="isReady";ServiceState[ServiceState.isLoading]="isLoading";ServiceState[ServiceState.isWaiting]="isWaiting";var LoadingMode={};LoadingMode.Direct=0;LoadingMode.Async=1;LoadingMode[LoadingMode.Direct]="Direct";LoadingMode[LoadingMode.Async]="Async";var Locale=function(){function Locale(locale,localization){var _this=this;this.locale=locale;this.localization=localization;if(this.localization!=null){this.lang=this.localization.languageCode;this.localization.translationChanged.subscribe(function(language){_this.lang=language})}if(this.locale!=null){this.defaultLocale=this.locale.getDefaultLocale();this.locale.defaultLocaleChanged.subscribe(function(defaultLocale){_this.defaultLocale=defaultLocale});this.currency=this.locale.getCurrentCurrency();this.locale.currencyCodeChanged.subscribe(function(currency){_this.currency=currency})}}return Locale}();var __extends=undefined&&undefined.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)};function isPresent(obj){return obj!==undefined&&obj!==null}var LocaleParser=function(){function LocaleParser(){}LocaleParser.NumberRegExpFactory=function(defaultLocale,digits){var minInt=1;var minFraction=0;var maxFraction=3;var NUMBER_FORMAT_REGEXP=/^(\d+)?\.((\d+)(\-(\d+))?)?$/;if(isPresent(digits)){var parts=digits.match(NUMBER_FORMAT_REGEXP);if(parts===null){throw new Error(digits+" is not a valid digit info for number")}if(isPresent(parts[1])){minInt=NumberWrapper.parseIntAutoRadix(parts[1])}if(isPresent(parts[3])){minFraction=NumberWrapper.parseIntAutoRadix(parts[3])}if(isPresent(parts[5])){maxFraction=NumberWrapper.parseIntAutoRadix(parts[5])}}var codes=new DecimalCode(defaultLocale);var minusSign=codes.minusSign;var zero=codes.numbers[0];var decimalSeparator=codes.decimalSeparator;var nine=codes.numbers[9];var pattern;if(minFraction>0&&maxFraction>0){pattern="^"+minusSign+"?["+zero+"-"+nine+"]{"+minInt+",}\\"+decimalSeparator+"["+zero+"-"+nine+"]{"+minFraction+","+maxFraction+"}$"}else if(minFraction==0&&maxFraction>0){pattern="^"+minusSign+"?["+zero+"-"+nine+"]{"+minInt+",}\\"+decimalSeparator+"?["+zero+"-"+nine+"]{"+minFraction+","+maxFraction+"}$"}else{pattern="^"+minusSign+"?["+zero+"-"+nine+"]{"+minInt+",}$"}pattern=codes.UnicodeToChar(pattern);var regExp=new RegExp(pattern);return regExp};LocaleParser.Number=function(s,defaultLocale){if(s==""||defaultLocale==""||defaultLocale==null){return null}var codes=new DecimalCode(defaultLocale);return codes.parse(s)};return LocaleParser}();var NumberCode=function(){function NumberCode(defaultLocale){this.defaultLocale=defaultLocale;this.numbers=[];for(var i=0;i<=9;i++){this.numbers.push(this.Unicode(i.toString()))}if(IntlSupport.NumberFormat(defaultLocale)==true){for(var i=0;i<=9;i++){this.numbers[i]=this.Unicode(new Intl.NumberFormat(defaultLocale).format(i))}}}NumberCode.prototype.parse=function(s){};NumberCode.prototype.UnicodeToChar=function(pattern){};NumberCode.prototype.Unicode=function(c){return"\\u"+this.HexEncode(c.charCodeAt(0))};NumberCode.prototype.HexEncode=function(value){var hex=value.toString(16).toUpperCase();hex="0000".substr(0,4-hex.length)+hex;return hex};return NumberCode}();var DecimalCode=function(_super){__extends(DecimalCode,_super);function DecimalCode(defaultLocale){_super.call(this,defaultLocale);this.defaultLocale=defaultLocale;this.minusSign=this.Unicode("-");this.decimalSeparator=this.Unicode(".");if(IntlSupport.NumberFormat(defaultLocale)==true){var value=-.9;var localeValue=new Intl.NumberFormat(defaultLocale).format(value);if(this.Unicode(localeValue.charAt(0))=="\\u200F"){this.minusSign=this.Unicode(localeValue.charAt(1));this.decimalSeparator=this.Unicode(localeValue.charAt(3))}else if(this.Unicode(localeValue.charAt(0))==this.Unicode(new Intl.NumberFormat(defaultLocale).format(0))){this.minusSign=this.Unicode(localeValue.charAt(3));this.decimalSeparator=this.Unicode(localeValue.charAt(1))}else{this.minusSign=this.Unicode(localeValue.charAt(0));this.decimalSeparator=this.Unicode(localeValue.charAt(2))}}}DecimalCode.prototype.parse=function(s){var characters=s.split("");var value="";for(var _i=0,characters_1=characters;_i<characters_1.length;_i++){var char=characters_1[_i];var charCode=this.Unicode(char);var index=this.numbers.indexOf(charCode);if(index!=-1){value+=index}else if(charCode==this.minusSign){value+="-"}else if(charCode==this.decimalSeparator){value+="."}else{return NaN}}return parseFloat(value)};DecimalCode.prototype.UnicodeToChar=function(pattern){return pattern.replace(/\\u[\dA-F]{4}/gi,function(match){return String.fromCharCode(parseInt(match.replace(/\\u/g,""),16))})};return DecimalCode}(NumberCode);var NumberWrapper=function(){function NumberWrapper(){}NumberWrapper.parseIntAutoRadix=function(text){var result=parseInt(text,null);if(isNaN(result)){throw new Error("Invalid integer literal when parsing "+text)}return result};NumberWrapper.parseInt=function(text,radix){if(radix==10){if(/^(\-|\+)?[0-9]+$/.test(text)){return parseInt(text,radix)}}else if(radix==16){if(/^(\-|\+)?[0-9ABCDEFabcdef]+$/.test(text)){return parseInt(text,radix)}}else{var result=parseInt(text,radix);if(!isNaN(result)){return result}}throw new Error("Invalid integer literal when parsing "+text+" in base "+radix)};return NumberWrapper}();var I18nPlural=function(){function I18nPlural(locale){this.locale=locale;this.REGEXP=/^\d+\b/}I18nPlural.prototype.translateNumber=function(key){this.keyStr=key;if(this.REGEXP.exec(key)!=null){var keyNum=parseFloat(key);this.keyStr=key.replace(this.REGEXP,"");this.keyStr=this.keyStr.trim();if(!isNaN(keyNum)&&IntlSupport.NumberFormat(this.locale.getDefaultLocale())==true){var localeDecimal=new _angular_common.DecimalPipe(this.locale.getDefaultLocale());key=key.replace(/^\d+/,localeDecimal.transform(keyNum,"1.0-3"))}}return key};return I18nPlural}();var LocaleDirective=function(){function LocaleDirective(locale,el,renderer){this.locale=locale;this.el=el;this.renderer=renderer}LocaleDirective.prototype.ngAfterViewInit=function(){var _this=this;var renderNode=this.el.nativeElement.childNodes[0];var value=renderNode.nodeValue;this.localize(renderNode,value);this.locale.defaultLocaleChanged.subscribe(function(){_this.localize(renderNode,value)})};LocaleDirective.prototype.localize=function(renderNode,value){};return LocaleDirective}();var __extends$1=undefined&&undefined.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)};var TranslatePipe=function(_super){__extends$1(TranslatePipe,_super);function TranslatePipe(localization,locale){_super.call(this,locale);this.localization=localization;this.locale=locale}TranslatePipe.prototype.transform=function(key,lang){var args=[];for(var _i=2;_i<arguments.length;_i++){args[_i-2]=arguments[_i]}if(this.localization.serviceState==ServiceState.isReady){key=this.translateNumber(key);var value=this.localization.translate(this.keyStr,args[0],lang);return key.replace(this.keyStr,value)}return""};TranslatePipe.decorators=[{type:_angular_core.Pipe,args:[{name:"translate",pure:true}]}];TranslatePipe.ctorParameters=function(){return[{type:LocalizationService},{type:LocaleService}]};return TranslatePipe}(I18nPlural);var LocaleDatePipe=function(){function LocaleDatePipe(){}LocaleDatePipe.prototype.transform=function(value,defaultLocale,pattern){if(pattern===void 0){pattern="mediumDate"}if(IntlSupport.DateTimeFormat(defaultLocale)==true){var localeDate=new _angular_common.DatePipe(defaultLocale);return localeDate.transform(value,pattern)}return value};LocaleDatePipe.decorators=[{type:_angular_core.Pipe,args:[{name:"localeDate",pure:true}]}];LocaleDatePipe.ctorParameters=function(){return[]};return LocaleDatePipe}();var LocaleDecimalPipe=function(){function LocaleDecimalPipe(){}LocaleDecimalPipe.prototype.transform=function(value,defaultLocale,digits){if(digits===void 0){digits=null}if(IntlSupport.NumberFormat(defaultLocale)==true){var localeDecimal=new _angular_common.DecimalPipe(defaultLocale);return localeDecimal.transform(value,digits)}return value};LocaleDecimalPipe.decorators=[{type:_angular_core.Pipe,args:[{name:"localeDecimal",pure:true}]}];LocaleDecimalPipe.ctorParameters=function(){return[]};return LocaleDecimalPipe}();var LocalePercentPipe=function(){function LocalePercentPipe(){}LocalePercentPipe.prototype.transform=function(value,defaultLocale,digits){if(digits===void 0){digits=null}if(IntlSupport.NumberFormat(defaultLocale)==true){var localePercent=new _angular_common.PercentPipe(defaultLocale);return localePercent.transform(value,digits)}return value};LocalePercentPipe.decorators=[{type:_angular_core.Pipe,args:[{name:"localePercent",pure:true}]}];LocalePercentPipe.ctorParameters=function(){return[]};return LocalePercentPipe}();var LocaleCurrencyPipe=function(){function LocaleCurrencyPipe(){}LocaleCurrencyPipe.prototype.transform=function(value,defaultLocale,currency,symbolDisplay,digits){if(symbolDisplay===void 0){symbolDisplay=false}if(digits===void 0){digits=null}if(IntlSupport.NumberFormat(defaultLocale)==true){var localeCurrency=new _angular_common.CurrencyPipe(defaultLocale);return localeCurrency.transform(value,currency,symbolDisplay,digits)}return value+" "+currency};LocaleCurrencyPipe.decorators=[{type:_angular_core.Pipe,args:[{name:"localeCurrency",pure:true}]}];LocaleCurrencyPipe.ctorParameters=function(){return[]};return LocaleCurrencyPipe}();var TranslateDirective=function(){function TranslateDirective(localization,el,renderer){this.localization=localization;this.el=el;this.renderer=renderer}TranslateDirective.prototype.ngAfterViewInit=function(){var _this=this;var renderNode=this.el.nativeElement.childNodes[0];var key=renderNode.nodeValue;this.translate(renderNode,key);this.localization.translationChanged.subscribe(function(){_this.translate(renderNode,key)})};TranslateDirective.prototype.translate=function(renderNode,key){var _this=this;this.localization.translateAsync(key,this.params).subscribe(function(value){_this.renderer.setText(renderNode,value)})};TranslateDirective.decorators=[{type:_angular_core.Directive,args:[{selector:"[translate]"}]}];TranslateDirective.ctorParameters=function(){return[{type:LocalizationService},{type:_angular_core.ElementRef},{type:_angular_core.Renderer}]};TranslateDirective.propDecorators={params:[{type:_angular_core.Input,args:["translate"]}]};return TranslateDirective}();var __extends$2=undefined&&undefined.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)};var LocaleDateDirective=function(_super){__extends$2(LocaleDateDirective,_super);function LocaleDateDirective(locale,el,renderer){_super.call(this,locale,el,renderer);this.locale=locale;this.defaultPattern="mediumDate"}LocaleDateDirective.prototype.localize=function(renderNode,value){var defaultLocale=this.locale.getDefaultLocale();if(IntlSupport.DateTimeFormat(defaultLocale)==true){var localeDate=new _angular_common.DatePipe(defaultLocale);this.renderer.setText(renderNode,localeDate.transform(value,this.pattern||this.defaultPattern))}};LocaleDateDirective.decorators=[{type:_angular_core.Directive,args:[{selector:"[localeDate]"}]}];LocaleDateDirective.ctorParameters=function(){return[{type:LocaleService},{type:_angular_core.ElementRef},{type:_angular_core.Renderer}]};LocaleDateDirective.propDecorators={pattern:[{type:_angular_core.Input,args:["localeDate"]}]};return LocaleDateDirective}(LocaleDirective);var __extends$3=undefined&&undefined.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)};var LocaleDecimalDirective=function(_super){__extends$3(LocaleDecimalDirective,_super);function LocaleDecimalDirective(locale,el,renderer){_super.call(this,locale,el,renderer);this.locale=locale;this.defaultDigits=null}LocaleDecimalDirective.prototype.localize=function(renderNode,value){var defaultLocale=this.locale.getDefaultLocale();if(IntlSupport.NumberFormat(defaultLocale)==true){var localeDecimal=new _angular_common.DecimalPipe(defaultLocale);this.renderer.setText(renderNode,localeDecimal.transform(value,this.digits||this.defaultDigits))}};LocaleDecimalDirective.decorators=[{type:_angular_core.Directive,args:[{selector:"[localeDecimal]"}]}];LocaleDecimalDirective.ctorParameters=function(){return[{type:LocaleService},{type:_angular_core.ElementRef},{type:_angular_core.Renderer}]};LocaleDecimalDirective.propDecorators={digits:[{type:_angular_core.Input,args:["localeDecimal"]}]};return LocaleDecimalDirective}(LocaleDirective);var LocalePercentDirective=function(_super){__extends$3(LocalePercentDirective,_super);function LocalePercentDirective(locale,el,renderer){_super.call(this,locale,el,renderer);this.locale=locale;this.defaultDigits=null}LocalePercentDirective.prototype.localize=function(renderNode,value){var defaultLocale=this.locale.getDefaultLocale();if(IntlSupport.NumberFormat(defaultLocale)==true){var localePercent=new _angular_common.PercentPipe(defaultLocale);this.renderer.setText(renderNode,localePercent.transform(value,this.digits||this.defaultDigits))}};LocalePercentDirective.decorators=[{type:_angular_core.Directive,args:[{selector:"[localePercent]"}]}];LocalePercentDirective.ctorParameters=function(){return[{type:LocaleService},{type:_angular_core.ElementRef},{type:_angular_core.Renderer}]};LocalePercentDirective.propDecorators={digits:[{type:_angular_core.Input,args:["localePercent"]}]};return LocalePercentDirective}(LocaleDirective);var LocaleCurrencyDirective=function(_super){__extends$3(LocaleCurrencyDirective,_super);function LocaleCurrencyDirective(locale,el,renderer){
_super.call(this,locale,el,renderer);this.locale=locale;this.symbolDisplay=false;this.defaultDigits=null}Object.defineProperty(LocaleCurrencyDirective.prototype,"symbol",{set:function(symbolDisplay){this.symbolDisplay=symbolDisplay||this.symbolDisplay},enumerable:true,configurable:true});LocaleCurrencyDirective.prototype.localize=function(renderNode,value){var defaultLocale=this.locale.getDefaultLocale();var currency=this.locale.getCurrentCurrency();if(IntlSupport.NumberFormat(defaultLocale)==true){var localeCurrency=new _angular_common.CurrencyPipe(defaultLocale);this.renderer.setText(renderNode,localeCurrency.transform(value,currency,this.symbolDisplay,this.digits||this.defaultDigits))}};LocaleCurrencyDirective.decorators=[{type:_angular_core.Directive,args:[{selector:"[localeCurrency]"}]}];LocaleCurrencyDirective.ctorParameters=function(){return[{type:LocaleService},{type:_angular_core.ElementRef},{type:_angular_core.Renderer}]};LocaleCurrencyDirective.propDecorators={digits:[{type:_angular_core.Input,args:["localeCurrency"]}],symbol:[{type:_angular_core.Input}]};return LocaleCurrencyDirective}(LocaleDirective);function validateLocaleNumber(locale,digits,MIN_VALUE,MAX_VALUE){if(MIN_VALUE===void 0){MIN_VALUE=Number.MIN_VALUE}if(MAX_VALUE===void 0){MAX_VALUE=Number.MAX_VALUE}var defaultLocale;var NUMBER_REGEXP;return function(c){if(defaultLocale!=locale.getDefaultLocale()){NUMBER_REGEXP=LocaleParser.NumberRegExpFactory(locale.getDefaultLocale(),digits);defaultLocale=locale.getDefaultLocale()}if(NUMBER_REGEXP.test(c.value)){var parsedValue;parsedValue=LocaleParser.Number(c.value,locale.getDefaultLocale());if(parsedValue<MIN_VALUE){return{minValue:{valid:false}}}else if(parsedValue>MAX_VALUE){return{maxValue:{valid:false}}}return null}else{return{format:{valid:false}}}}}var LocaleNumberValidator=function(){function LocaleNumberValidator(locale){this.locale=locale;this.MIN_VALUE=Number.MIN_VALUE;this.MAX_VALUE=Number.MAX_VALUE}Object.defineProperty(LocaleNumberValidator.prototype,"minValue",{set:function(value){this.MIN_VALUE=value||this.MIN_VALUE},enumerable:true,configurable:true});Object.defineProperty(LocaleNumberValidator.prototype,"maxValue",{set:function(value){this.MAX_VALUE=value||this.MAX_VALUE},enumerable:true,configurable:true});LocaleNumberValidator.prototype.ngOnInit=function(){this.validator=validateLocaleNumber(this.locale,this.digits,this.MIN_VALUE,this.MAX_VALUE)};LocaleNumberValidator.prototype.validate=function(c){return this.validator(c)};LocaleNumberValidator.decorators=[{type:_angular_core.Directive,args:[{selector:"[validateLocaleNumber][ngModel],[validateLocaleNumber][formControl]",providers:[{provide:_angular_forms.NG_VALIDATORS,useExisting:_angular_core.forwardRef(function(){return LocaleNumberValidator}),multi:true}]}]}];LocaleNumberValidator.ctorParameters=function(){return[{type:LocaleService}]};LocaleNumberValidator.propDecorators={digits:[{type:_angular_core.Input,args:["validateLocaleNumber"]}],minValue:[{type:_angular_core.Input}],maxValue:[{type:_angular_core.Input}]};return LocaleNumberValidator}();var LocaleModule=function(){function LocaleModule(){}LocaleModule.forRoot=function(){return{ngModule:LocaleModule,providers:[LocaleService]}};LocaleModule.forChild=function(){return{ngModule:LocaleModule,providers:[LocaleService]}};LocaleModule.decorators=[{type:_angular_core.NgModule,args:[{declarations:[LocaleDatePipe,LocaleDecimalPipe,LocalePercentPipe,LocaleCurrencyPipe,LocaleDateDirective,LocaleDecimalDirective,LocalePercentDirective,LocaleCurrencyDirective,LocaleNumberValidator],exports:[LocaleDatePipe,LocaleDecimalPipe,LocalePercentPipe,LocaleCurrencyPipe,LocaleDateDirective,LocaleDecimalDirective,LocalePercentDirective,LocaleCurrencyDirective,LocaleNumberValidator]}]}];LocaleModule.ctorParameters=function(){return[]};return LocaleModule}();var LocalizationModule=function(){function LocalizationModule(){}LocalizationModule.forRoot=function(){return{ngModule:LocalizationModule,providers:[LocalizationService]}};LocalizationModule.forChild=function(){return{ngModule:LocalizationModule,providers:[LocalizationService]}};LocalizationModule.decorators=[{type:_angular_core.NgModule,args:[{declarations:[TranslatePipe,TranslateDirective],exports:[TranslatePipe,TranslateDirective]}]}];LocalizationModule.ctorParameters=function(){return[]};return LocalizationModule}();exports.LocaleModule=LocaleModule;exports.LocalizationModule=LocalizationModule;exports.LocalizationService=LocalizationService;exports.ServiceState=ServiceState;exports.LoadingMode=LoadingMode;exports.LocaleService=LocaleService;exports.Locale=Locale;exports.IntlSupport=IntlSupport;exports.LocaleParser=LocaleParser;exports.NumberCode=NumberCode;exports.LocaleDirective=LocaleDirective;exports.I18nPlural=I18nPlural;exports.TranslatePipe=TranslatePipe;exports.LocaleDatePipe=LocaleDatePipe;exports.LocaleDecimalPipe=LocaleDecimalPipe;exports.LocalePercentPipe=LocalePercentPipe;exports.LocaleCurrencyPipe=LocaleCurrencyPipe;exports.TranslateDirective=TranslateDirective;exports.LocaleDateDirective=LocaleDateDirective;exports.LocaleDecimalDirective=LocaleDecimalDirective;exports.LocalePercentDirective=LocalePercentDirective;exports.LocaleCurrencyDirective=LocaleCurrencyDirective;exports.LocaleNumberValidator=LocaleNumberValidator;exports.validateLocaleNumber=validateLocaleNumber;Object.defineProperty(exports,"__esModule",{value:true})});